import React, { useState } from 'react';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';

export default function KeywordVisualization() {
  const [selectedKeywords, setSelectedKeywords] = useState(['man', 'woman', 'people', 'wearing', 'young']);

  const data = {
    bert_lora: {
      man: 7728, woman: 3879, people: 3268, wearing: 2338, young: 1820,
      shirt: 1750, men: 1705, white: 1702, girl: 1659, black: 1589,
      boy: 1577, dog: 1505, playing: 1496, blue: 1383, sitting: 1343,
      standing: 1263, red: 1210, group: 1179, outside: 1046, street: 1043
    },
    bert_partial: {
      man: 8044, woman: 4041, people: 3491, wearing: 2431, shirt: 1918,
      young: 1851, white: 1802, men: 1743, girl: 1716, black: 1679,
      boy: 1624, playing: 1565, dog: 1554, blue: 1478, sitting: 1442,
      standing: 1290, group: 1271, red: 1250, outside: 1077, person: 1074
    },
    distil_lora: {
      man: 9019, woman: 4495, people: 3859, wearing: 2765, shirt: 2129,
      young: 2056, men: 1971, girl: 1941, white: 1939, black: 1866,
      boy: 1782, playing: 1719, dog: 1712, blue: 1603, sitting: 1531,
      standing: 1443, red: 1415, group: 1357, street: 1238, outside: 1212
    },
    distil_partial: {
      man: 10004, woman: 5212, people: 4362, wearing: 3017, young: 2420,
      shirt: 2357, men: 2186, white: 2170, black: 2108, boy: 2104,
      girl: 2086, playing: 2007, dog: 1904, blue: 1835, sitting: 1803,
      standing: 1685, red: 1602, group: 1550, outside: 1401, street: 1392
    }
  };

  const allKeywords = Object.keys(data.bert_lora).sort();

  const chartData = selectedKeywords.map(keyword => ({
    keyword,
    bert_lora: data.bert_lora[keyword],
    bert_partial: data.bert_partial[keyword],
    distil_lora: data.distil_lora[keyword],
    distil_partial: data.distil_partial[keyword]
  }));

  return (
    <div className="w-full h-full bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-8">
      <div className="max-w-6xl mx-auto">
        <h1 className="text-3xl font-bold text-white mb-2">Top Keywords Comparison</h1>
        <p className="text-slate-300 mb-6">Across different model configurations</p>

        <div className="bg-slate-700 rounded-lg p-6 mb-6">
          <h2 className="text-white font-semibold mb-4">Select Keywords</h2>
          <div className="grid grid-cols-4 gap-2">
            {allKeywords.map(keyword => (
              <button
                key={keyword}
                onClick={() => {
                  if (selectedKeywords.includes(keyword)) {
                    setSelectedKeywords(selectedKeywords.filter(k => k !== keyword));
                  } else {
                    setSelectedKeywords([...selectedKeywords, keyword]);
                  }
                }}
                className={`px-3 py-2 rounded text-sm font-medium transition ${
                  selectedKeywords.includes(keyword)
                    ? 'bg-blue-500 text-white'
                    : 'bg-slate-600 text-slate-200 hover:bg-slate-500'
                }`}
              >
                {keyword}
              </button>
            ))}
          </div>
        </div>

        <div className="bg-slate-800 rounded-lg p-6 border border-slate-700">
          <ResponsiveContainer width="100%" height={400}>
            <BarChart data={chartData} margin={{ top: 20, right: 30, left: 0, bottom: 60 }}>
              <CartesianGrid strokeDasharray="3 3" stroke="#475569" />
              <XAxis 
                dataKey="keyword" 
                angle={-45}
                textAnchor="end"
                height={100}
                tick={{ fill: '#cbd5e1', fontSize: 12 }}
              />
              <YAxis tick={{ fill: '#cbd5e1' }} />
              <Tooltip 
                contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                labelStyle={{ color: '#e2e8f0' }}
                cursor={{ fill: 'rgba(59, 130, 246, 0.1)' }}
              />
              <Legend wrapperStyle={{ paddingTop: '20px' }} />
              <Bar dataKey="bert_lora" fill="#3b82f6" />
              <Bar dataKey="bert_partial" fill="#8b5cf6" />
              <Bar dataKey="distil_lora" fill="#ec4899" />
              <Bar dataKey="distil_partial" fill="#f59e0b" />
            </BarChart>
          </ResponsiveContainer>
        </div>

        <div className="grid grid-cols-4 gap-4 mt-6">
          {[
            { name: 'BERT LoRA', color: '#3b82f6' },
            { name: 'BERT Partial', color: '#8b5cf6' },
            { name: 'Distil LoRA', color: '#ec4899' },
            { name: 'Distil Partial', color: '#f59e0b' }
          ].map(model => (
            <div key={model.name} className="bg-slate-800 rounded-lg p-4 border border-slate-700">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-3 h-3 rounded" style={{ backgroundColor: model.color }}></div>
                <p className="text-slate-200 font-medium">{model.name}</p>
              </div>
              <p className="text-slate-400 text-sm">Model variant</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
